@model List<CoursePlatform.Models.Enrollment>
@{
    ViewData["Title"] = "My courses";
}

<div class="d-flex justify-content-between align-items-center mt-3 mb-3">
    <h2 class="mb-0" id="myCoursesTitle" data-testid="my-courses-title">My courses</h2>
    <a class="btn btn-outline-secondary"
       asp-controller="Courses"
       asp-action="Index"
       id="goAllCoursesBtn"
       data-testid="go-all-courses">
        All courses
    </a>
</div>

@if (!Model.Any())
{
    <div class="alert alert-secondary"
         id="emptyMyCourses"
         data-testid="empty-my-courses">
        No courses yet.
    </div>
}
else
{
    <table class="table table-striped"
           id="myCoursesTable"
           data-testid="my-courses-table">
        <thead>
        <tr>
            <th>Title</th>
            <th>Teacher</th>
            <th>Enrolled</th>
            <th style="width:160px;">Action</th>
        </tr>
        </thead>
        <tbody>
        @foreach (var e in Model)
        {
            <tr id="myCourseRow_@e.CourseId"
                data-course-id="@e.CourseId"
                data-testid="my-course-row">
                <td class="course-title" data-testid="my-course-title">@e.Course?.Title</td>
                <td data-testid="my-course-teacher">@(e.Course?.Teacher?.Email ?? "-")</td>
                <td data-testid="my-course-enrolled">@e.EnrolledAt.ToString("yyyy-MM-dd")</td>
                <td>
                    <form method="post"
                          asp-action="Unenroll"
                          asp-route-courseId="@e.CourseId"
                          class="d-inline">
                        @Html.AntiForgeryToken()
                        <button type="submit"
                                class="btn btn-sm btn-outline-danger"
                                id="unenrollBtn_@e.CourseId"
                                data-testid="unenroll-btn">
                            Unenroll
                        </button>
                    </form>
                </td>
            </tr>
        }
        </tbody>
    </table>
}
